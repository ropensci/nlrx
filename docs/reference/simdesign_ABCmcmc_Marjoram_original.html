<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add an Approximate Bayesian Computation (Monte-Carlo Markov-Chain) simdesign using the Majoram Original algorithm to a nl object — simdesign_ABCmcmc_Marjoram_original • nlrx | NetLogo from R</title><!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add an Approximate Bayesian Computation (Monte-Carlo Markov-Chain) simdesign using the Majoram Original algorithm to a nl object — simdesign_ABCmcmc_Marjoram_original"><meta name="description" content="Add an Approximate Bayesian Computation (Monte-Carlo Markov-Chain) simdesign using the Majoram Original algorithm to a nl object"><meta property="og:description" content="Add an Approximate Bayesian Computation (Monte-Carlo Markov-Chain) simdesign using the Majoram Original algorithm to a nl object"><meta property="og:image" content="https://docs.ropensci.org/nlrx/logo.png"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css"><script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">nlrx | NetLogo from R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/getstarted.html"><span class="fa fa-magic"></span> Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/furthernotes.html"><span class="fa fa-book"></span> Advanced configuration</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">More</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-more"><li><a class="dropdown-item" href="../articles/articles/spatial-output.html"><span class="fa fa-location-arrow"></span> Capturing spatial NetLogo output</a></li>
    <li><a class="dropdown-item" href="../articles/articles/manual-output.html"><span class="fa fa-location-arrow"></span> Capturing NetLogo output manually</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity.html"><span class="fa fa-gear"></span> Sensitivity Analysis with nlrx</a></li>
    <li><a class="dropdown-item" href="../articles/optimization.html"><span class="fa fa-gear"></span> Optimization with nlrx</a></li>
    <li><a class="dropdown-item" href="../articles/abc.html"><span class="fa fa-gear"></span> Approximate Bayesian Computation (ABC) with nlrx</a></li>
    <li><a class="dropdown-item" href="../articles/simdesign-examples.html"><span class="fa fa-gear"></span> Simdesign examples</a></li>
    <li><a class="dropdown-item" href="../articles/articles/interfacing-different-models.html"><span class="fa fa-image"></span> Interfacing a variety of different NetLogo models</a></li>
    <li><a class="dropdown-item" href="../articles/articles/nlrx_nldoc.html"><span class="fa fa-book"></span> NetLogo documentation with nlrx</a></li>
    <li><a class="dropdown-item" href="../articles/articles/nlrx_papers.html"><span class="fa fa-bookmark"></span> Publication record</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/abc.html">Approximate Bayesian Computation (ABC)</a></li>
    <li><a class="dropdown-item" href="../articles/furthernotes.html">Advanced configuration</a></li>
    <li><a class="dropdown-item" href="../articles/getstarted.html">Get Started</a></li>
    <li><a class="dropdown-item" href="../articles/interfacing-different-models.html">Interfacing a variety of different NetLogo models</a></li>
    <li><a class="dropdown-item" href="../articles/manual-output.html">Capturing NetLogo output manually</a></li>
    <li><a class="dropdown-item" href="../articles/nlrx_nldoc.html">NetLogo documentation with nlrx</a></li>
    <li><a class="dropdown-item" href="../articles/nlrx_papers.html">Publication record</a></li>
    <li><a class="dropdown-item" href="../articles/optimization.html">Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity.html">Sensitivity Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/simdesign-examples.html">Simdesign examples</a></li>
    <li><a class="dropdown-item" href="../articles/spatial-output.html">Spatial Output</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/nlrx/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add an Approximate Bayesian Computation (Monte-Carlo Markov-Chain) simdesign using the Majoram Original algorithm to a nl object</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/nlrx/blob/HEAD/R/simdesign_helper.R" class="external-link"><code>R/simdesign_helper.R</code></a></small>
      <div class="d-none name"><code>simdesign_ABCmcmc_Marjoram_original.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add an Approximate Bayesian Computation (Monte-Carlo Markov-Chain) simdesign using the Majoram Original algorithm to a nl object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simdesign_ABCmcmc_Marjoram_original</span><span class="op">(</span></span>
<span>  <span class="va">nl</span>,</span>
<span>  postpro_function <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">summary_stat_target</span>,</span>
<span>  prior_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">n_rec</span>,</span>
<span>  n_between_sampling <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  n_cluster <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  use_seed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dist_weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dist_max <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tab_normalization <span class="op">=</span> <span class="va">summary_stat_target</span>,</span>
<span>  proposal_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"numeric"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="getexp.html">getexp</a></span><span class="op">(</span><span class="va">nl</span>, <span class="st">"variables"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed_count <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress_bar <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">nseeds</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-nl">nl<a class="anchor" aria-label="anchor" href="#arg-nl"></a></dt>
<dd><p>nl object with a defined experiment</p></dd>


<dt id="arg-postpro-function">postpro_function<a class="anchor" aria-label="anchor" href="#arg-postpro-function"></a></dt>
<dd><p>default is NULL. Allows to provide a function that is called to post-process the output Tibble of the NetLogo simulations. The function must accept the nl object with attached results as input argument. The function must return a one-dimensional vector of output metrics that corresponds in leght and order to the specified summary_stat_target.</p></dd>


<dt id="arg-summary-stat-target">summary_stat_target<a class="anchor" aria-label="anchor" href="#arg-summary-stat-target"></a></dt>
<dd><p>a vector of target values in the same order as the defined metrics of the experiment</p></dd>


<dt id="arg-prior-test">prior_test<a class="anchor" aria-label="anchor" href="#arg-prior-test"></a></dt>
<dd><p>a string expressing the constraints between model parameters. This expression will be evaluated as a logical expression, you can use all the logical operators including "&lt;", "&gt;", ... Each parameter should be designated with "X1", "X2", ... in the same order as in the prior definition. Set to NULL to disable.</p></dd>


<dt id="arg-n-rec">n_rec<a class="anchor" aria-label="anchor" href="#arg-n-rec"></a></dt>
<dd><p>Number of samples along the MCMC</p></dd>


<dt id="arg-n-between-sampling">n_between_sampling<a class="anchor" aria-label="anchor" href="#arg-n-between-sampling"></a></dt>
<dd><p>a positive integer equal to the desired spacing between sampled points along the MCMC.</p></dd>


<dt id="arg-n-cluster">n_cluster<a class="anchor" aria-label="anchor" href="#arg-n-cluster"></a></dt>
<dd><p>number of cores to parallelize simulations. Due to the design of the EasyABC parallelization it is currently not possible to use this feature with cores &gt; 1.</p></dd>


<dt id="arg-use-seed">use_seed<a class="anchor" aria-label="anchor" href="#arg-use-seed"></a></dt>
<dd><p>if TRUE, seeds will be automatically created for each new model run</p></dd>


<dt id="arg-dist-weights">dist_weights<a class="anchor" aria-label="anchor" href="#arg-dist-weights"></a></dt>
<dd><p>a vector containing the weights to apply to the distance between the computed and the targeted statistics. These weights can be used to give more importance to a summary statistic for example. The weights will be normalized before applying them. Set to NULL to disable.</p></dd>


<dt id="arg-dist-max">dist_max<a class="anchor" aria-label="anchor" href="#arg-dist-max"></a></dt>
<dd><p>a positive number. This is the tolerance threshold used during the MCMC. If not provided by the user, it is automatically computed as half the distance between the first simulation and the target summary statistics and a warning is printed.</p></dd>


<dt id="arg-tab-normalization">tab_normalization<a class="anchor" aria-label="anchor" href="#arg-tab-normalization"></a></dt>
<dd><p>a vector of the same length as summary_stat_target. Each element contains a positive number by which each summary statistics must be divided before the computation of the Euclidean distance between simulations and data. If not provided by the user, the simulated summary statistics are divided by the target summary statistics and a warning is printed.</p></dd>


<dt id="arg-proposal-range">proposal_range<a class="anchor" aria-label="anchor" href="#arg-proposal-range"></a></dt>
<dd><p>a vector of the same length as the number of model parameters, used when method is "Marjoram_original". Each element contains a positive number defining the range of MCMC jumps for each model parameter. If not provided by the user, a default value is used for each parameter and a warning is printed. The default value is 1/50 of the prior range for uniform distributions, 1/20 of the standard deviation of the prior distribution for normal distributions, 1/20 * exp ( sigma * sigma</p></dd>


<dt id="arg-seed-count">seed_count<a class="anchor" aria-label="anchor" href="#arg-seed-count"></a></dt>
<dd><p>a positive integer, the initial seed value provided to the function model (if use_seed=TRUE). This value is incremented by 1 at each call of the function model.</p></dd>


<dt id="arg-progress-bar">progress_bar<a class="anchor" aria-label="anchor" href="#arg-progress-bar"></a></dt>
<dd><p>logical, FALSE by default. If TRUE, ABC_mcmc will output a bar of progression with the estimated remaining computing time. Option not available with multiple cores.</p></dd>


<dt id="arg-nseeds">nseeds<a class="anchor" aria-label="anchor" href="#arg-nseeds"></a></dt>
<dd><p>number of seeds for this simulation design</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>simdesign S4 class object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function creates a simdesign S4 class which can be added to a nl object.</p>
<p>Variables in the experiment variable list need to provide a numeric distribution with min, max and a shape of the distribution (qunif, qnorm, qlnorm, qexp)(e.g. list(min=1, max=4, qfun="qunif")).</p>
<p>The function uses the EasyABC package to set up the ABC_mcmc function.
For details on the ABC_mcmc function parameters see ?EasyABC::ABC_mcmc
Finally, the function reports a simdesign object.</p>
<p>Approximate Bayesian Computation simdesigns can only be executed using the <a href="run_nl_dyn.html">run_nl_dyn</a> function instead of <a href="run_nl_all.html">run_nl_all</a> or <a href="run_nl_one.html">run_nl_one</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To attach a simdesign, a nl object needs to be created first (see ?nl).</span></span></span>
<span class="r-in"><span><span class="co"># For this example, we load a nl object from test data.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">nl</span> <span class="op">&lt;-</span> <span class="va">nl_lhs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Attach the simdesign to the nl object</span></span></span>
<span class="r-in"><span><span class="va">nl</span><span class="op">@</span><span class="va">simdesign</span> <span class="op">&lt;-</span> <span class="fu">simdesign_ABCmcmc_Marjoram_original</span><span class="op">(</span>nl <span class="op">=</span> <span class="va">nl</span>,</span></span>
<span class="r-in"><span>                                                     summary_stat_target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">80</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                                     n_rec <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                                                     n_between_sampling <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                                                     nseeds <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating ABC Monte-Carlo Markov-Chain simulation design</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>





  </body></html>

