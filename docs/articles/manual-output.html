<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nlrx">
<title>Capturing NetLogo output manually • nlrx | NetLogo from R</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Capturing NetLogo output manually">
<meta property="og:description" content="nlrx">
<meta property="og:image" content="https://docs.ropensci.org/nlrx/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">nlrx | NetLogo from R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/getstarted.html">
    <span class="fa fa fa fa-magic"></span>
     
    Get Started
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/furthernotes.html">
    <span class="fa fa-book"></span>
     
    Advanced configuration
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <a class="dropdown-item" href="../articles/articles/spatial-output.html">
      <span class="fa fa-location-arrow"></span>
       
      Capturing spatial NetLogo output
    </a>
    <a class="dropdown-item" href="../articles/articles/manual-output.html">
      <span class="fa fa-location-arrow"></span>
       
      Capturing NetLogo output manually
    </a>
    <a class="dropdown-item" href="../articles/sensitivity.html">
      <span class="fa fa-gear"></span>
       
      Sensitivity Analysis with nlrx
    </a>
    <a class="dropdown-item" href="../articles/optimization.html">
      <span class="fa fa-gear"></span>
       
      Optimization with nlrx
    </a>
    <a class="dropdown-item" href="../articles/abc.html">
      <span class="fa fa-gear"></span>
       
      Approximate Bayesian Computation (ABC) with nlrx
    </a>
    <a class="dropdown-item" href="../articles/simdesign-examples.html">
      <span class="fa fa-gear"></span>
       
      Simdesign examples
    </a>
    <a class="dropdown-item" href="../articles/articles/interfacing-different-models.html">
      <span class="fa fa-image"></span>
       
      Interfacing a variety of different NetLogo models
    </a>
    <a class="dropdown-item" href="../articles/articles/nlrx_nldoc.html">
      <span class="fa fa-book"></span>
       
      NetLogo documentation with nlrx
    </a>
    <a class="dropdown-item" href="../articles/articles/nlrx_papers.html">
      <span class="fa fa-bookmark"></span>
       
      Publication record
    </a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/nlrx">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Capturing NetLogo output manually</h1>
                        <h4 data-toc-skip class="author">Jan
Salecker</h4>
            
            <h4 data-toc-skip class="date">2023-05-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/nlrx/blob/HEAD/vignettes/articles/manual-output.Rmd" class="external-link"><code>vignettes/articles/manual-output.Rmd</code></a></small>
      <div class="d-none name"><code>manual-output.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="capturing-output-manually">Capturing output manually<a class="anchor" aria-label="anchor" href="#capturing-output-manually"></a>
</h2>
<p>While nlrx provides the <code>metrics</code>,
<code>metrics.turtles</code>, <code>metrics.patches</code> and
<code>metrics.links</code> slots of the <code>exerpiment</code> class to
capture global and agent related output from NetLogo models, this might
not be sufficient under certain circumstances. For example, the
<code>metrics</code> slot cannot track and collect nested list output or
similar complex data structures such as NetLogo arrays or matrices.
Another example would be spatial output such as shapefiles or grids,
generated with the GIS extension. Additionally, you might already have
implemented complex routines in your model which write model output to
disk.</p>
<p>The main question for this vignette to answer is: How can you link
such self-written output to your nlrx experiment. Here we show you one
basic example how this works. In this example we write ascii raster
files using the GIS extension in NetLogo. However, the same workflow can
of course be applied to other types of output, for example text files
written with <code>file-type</code> primitives or the csv extension.</p>
<div class="section level4">
<h4 id="step-1-creating-an-id-widget-on-your-model-interface">Step 1: Creating an ID widget on your model interface<a class="anchor" aria-label="anchor" href="#step-1-creating-an-id-widget-on-your-model-interface"></a>
</h4>
<p>In order to link self-written output to our nlrx simulations within
the R session, we need to transfer the current nlrx siminputrow and seed
to our NetLogo model. That way, when executing
<code><a href="../reference/run_nl_all.html">run_nl_all()</a></code>, within each simulation the NetLogo model
exactly “knows” which parameter row (siminputrow) is currently simulated
and the corresponding random seed. To transfer this information we just
need to create a string input widget on our model interface. In the
example below, we created such a widget at the bottom of the Wolf Sheep
model called <code>nlrx_id</code>.</p>
<center>
<img src="idrunnum_gui.PNG" align="center" width="75%">
</center>
</div>
<div class="section level4">
<h4 id="step-2-define-idrunnum-of-the-experiment">Step 2: Define idrunnum of the experiment<a class="anchor" aria-label="anchor" href="#step-2-define-idrunnum-of-the-experiment"></a>
</h4>
<p>The idrunnum field of the experiment is a built-in feature that
allows to transfer the current experiment name, siminputrow and random
seed to a defined NetLogo gui parameter widget. In our case we want to
use our newly created <code>nlrx_id</code> string input field, so we
just set <code>idrunnum = nlrx_id</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Attach experiment</span></span>
<span><span class="va">nl</span><span class="op">@</span><span class="va">experiment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/experiment.html">experiment</a></span><span class="op">(</span>expname<span class="op">=</span><span class="st">"wolf-sheep"</span>,</span>
<span>                            outpath<span class="op">=</span><span class="va">outpath</span>,</span>
<span>                            repetition<span class="op">=</span><span class="fl">1</span>,</span>
<span>                            tickmetrics<span class="op">=</span><span class="st">"true"</span>,</span>
<span>                            idsetup<span class="op">=</span><span class="st">"setup"</span>,</span>
<span>                            idgo<span class="op">=</span><span class="st">"go"</span>,</span>
<span>                            idrunnum<span class="op">=</span><span class="st">"nlrx_id"</span>,</span>
<span>                            runtime<span class="op">=</span><span class="fl">50</span>,</span>
<span>                            evalticks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">50</span><span class="op">)</span>,</span>
<span>                            metrics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"count sheep"</span><span class="op">)</span>,</span>
<span>                            variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'initial-number-sheep'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min<span class="op">=</span><span class="fl">50</span>, max<span class="op">=</span><span class="fl">150</span>, qfun<span class="op">=</span><span class="st">"qunif"</span><span class="op">)</span>,</span>
<span>                                             <span class="st">'initial-number-wolves'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>min<span class="op">=</span><span class="fl">50</span>, max<span class="op">=</span><span class="fl">150</span>, qfun<span class="op">=</span><span class="st">"qunif"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                            constants <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"model-version"</span> <span class="op">=</span> <span class="st">"\"sheep-wolves-grass\""</span>,</span>
<span>                                             <span class="st">"grass-regrowth-time"</span> <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                                             <span class="st">"sheep-gain-from-food"</span> <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                             <span class="st">"wolf-gain-from-food"</span> <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                             <span class="st">"sheep-reproduce"</span> <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                                             <span class="st">"wolf-reproduce"</span> <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                             <span class="st">"show-energy?"</span> <span class="op">=</span> <span class="st">"false"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="step-3-use-nlrx_id-within-netlogo-model-to-tag-self-written-output">Step 3: Use nlrx_id within NetLogo model to tag self-written
output<a class="anchor" aria-label="anchor" href="#step-3-use-nlrx_id-within-netlogo-model-to-tag-self-written-output"></a>
</h4>
<p>We can now use the <code>nlrx_id</code> field within the NetLogo
model to tag our self-written output. One way to do this is to tag the
filenames of self-written output. Here is an example where raster grids
are created and written at the end of each model run:</p>
<pre class="netlogo"><code>to write_final_landscape
  let filename (word nlrx_id "_" but-first (word (1000 + ticks)) ".asc")
  if (file-exists? filename) [file-delete filename]
  gis:store-dataset final_landscape filename  
end</code></pre>
<p>Here, we first create our filename by using the string from the
<code>nlrx_id</code> field (which contains the current experiment name,
siminputrow and random seed divided by an underscore) and add the
current tick (containing leading zeros by adding 1000 to the tick count
and removing the first number afterwards).</p>
<p>Of course you could also use different approaches to utilize the
information within the <code>nlrx_id</code> field for tagging your
output.</p>
</div>
<div class="section level4">
<h4 id="step-4-linking-self-written-output-to-nlrx-collected-output">Step 4: Linking self-written output to nlrx collected output<a class="anchor" aria-label="anchor" href="#step-4-linking-self-written-output-to-nlrx-collected-output"></a>
</h4>
<p>Finally, we want to read in our self-written raster files, calculate
some landscape metrics and add those to the results table that we
received from the <code><a href="../reference/run_nl_all.html">run_nl_all()</a></code> function.</p>
<p>We basically have two types of output now: The tibble from our model
executions, and a folder with self-written output (here defined as a
subfolder of our modelpath).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Output from nlrx simulations:</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_nl_all.html">run_nl_all</a></span><span class="op">(</span><span class="va">nl</span><span class="op">)</span></span>
<span><span class="co">## Self-writte output directory:</span></span>
<span><span class="va">ascdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">nl</span><span class="op">@</span><span class="va">modelpath</span><span class="op">)</span>, <span class="st">"output"</span><span class="op">)</span></span></code></pre></div>
<p>We can now loop over the files in that folder, read the content and
use the <code>strplit</code> function on the filename to identify the
experiment name, the siminputrow, the random seed and the tick count. As
an example application, we then calculate some landscapemetrics using
the <code>landscapemetrics</code> package. Finally we put everything
into a results tibble:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results.lsm</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">ascdir</span>, pattern <span class="op">=</span> <span class="st">"asc"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x.split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"_"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">x.tick</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x.split</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x.split</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>, <span class="st">"\\."</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">x.siminputrow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x.split</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x.split</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">x.seed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x.split</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x.split</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">x.raster</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## netlogo asc files use NaN as default nodata value in the asc file header</span></span>
<span>  <span class="co">## this leads to problems when reading the raster because it sets ´zeros to NA</span></span>
<span>  <span class="co">## here we set NAs back to zertos manually:</span></span>
<span>  <span class="va">x.raster</span> <span class="op">&lt;-</span> <span class="fu">reclassify</span><span class="op">(</span><span class="va">x.raster</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## Calculate landscape metrics:</span></span>
<span>  <span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lsm_l_ed"</span>, <span class="st">"lsm_l_shdi"</span>, <span class="st">"lsm_l_lsi"</span>, <span class="st">"lsm_l_lpi"</span>, <span class="st">"lsm_l_area_mn"</span><span class="op">)</span></span>
<span>  <span class="va">x.metrics</span> <span class="op">&lt;-</span> <span class="fu">landscapemetrics</span><span class="fu">::</span><span class="fu">calculate_lsm</span><span class="op">(</span><span class="va">x.raster</span>, what<span class="op">=</span><span class="va">metrics</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">metric</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from<span class="op">=</span><span class="va">metric</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">x.final</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>siminputrow <span class="op">=</span> <span class="va">x.siminputrow</span>,</span>
<span>                            `[step]` <span class="op">=</span> <span class="va">x.tick</span>,</span>
<span>                            `random-seed` <span class="op">=</span> <span class="va">x.seed</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">x.final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x.final</span>, <span class="va">x.metrics</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x.final</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Now we have the same identifier columns in the nlrx reported output
and the self-written output tibble which allows us to join both tibbles
together:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Combine results with lsm and store:</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">results.lsm</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"siminputrow"</span>, <span class="st">"random-seed"</span>, <span class="st">"[step]"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Attach output to nl object:</span></span>
<span><span class="fu"><a href="../reference/setsim.html">setsim</a></span><span class="op">(</span><span class="va">nl</span>, <span class="st">"simoutput"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">nl</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outpath</span>, <span class="st">"my_final_nl_object.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://twitter.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-twitter"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
